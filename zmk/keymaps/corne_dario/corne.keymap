// AUTO-GENERATED - DO NOT EDIT
// Generated from config/keymap.yaml
// Board: Chocofi
// Shield/Board: corne

#include <behaviors.dtsi>
#include <dt-bindings/zmk/keys.h>
#include <dt-bindings/zmk/bt.h>
#include "dario_behaviors.dtsi"

#define BASE_PRIMARY 0
#define BASE_ALT 1
#define BASE_ALT2 2
#define SYM 3
#define NUM 4
#define NAV 5
#define MEDIA 6
#define SYM_SHADOW 7

/ {

    combos {
        compatible = "zmk,combos";

        combo_dfu_left {
            timeout-ms = <100>;
            key-positions = <1 5 29>;
            bindings = <&bootloader>;
            layers = <0 1 2>;
            require-prior-idle-ms = <150>;
        };

        combo_dfu_right {
            timeout-ms = <100>;
            key-positions = <6 10 30>;
            bindings = <&bootloader>;
            layers = <0 1 2>;
            require-prior-idle-ms = <150>;
        };

        combo_github_url {
            timeout-ms = <100>;
            key-positions = <7 8 9 10>;
            bindings = <&github_url>;
            layers = <0 1 2>;
        };

        combo_ht_to_lm {
            timeout-ms = <20>;
            key-positions = <15 16>;
            bindings = <&ht_to_lm>;
            layers = <0>;
        };

        combo_sth_to_llm {
            timeout-ms = <30>;
            key-positions = <14 15 16>;
            bindings = <&sth_to_llm>;
            layers = <0>;
        };

        combo_cae_to_cyc {
            timeout-ms = <30>;
            key-positions = <19 20 21>;
            bindings = <&cae_to_cyc>;
            layers = <0>;
        };
    };

    macros {
        ht_to_lm: ht_to_lm_macro {
            compatible = "zmk,behavior-macro";
            label = "HT_TO_LM";
            #binding-cells = <0>;
            bindings
                = <&macro_wait_time 10>
                , <&macro_tap_time 10>
                , <&macro_tap &kp L &kp M>
                ;
        };
        sth_to_llm: sth_to_llm_macro {
            compatible = "zmk,behavior-macro";
            label = "STH_TO_LLM";
            #binding-cells = <0>;
            bindings
                = <&macro_wait_time 10>
                , <&macro_tap_time 10>
                , <&macro_tap &kp L &kp L &kp M>
                ;
        };
        cae_to_cyc: cae_to_cyc_macro {
            compatible = "zmk,behavior-macro";
            label = "CAE_TO_CYC";
            #binding-cells = <0>;
            bindings
                = <&macro_wait_time 10>
                , <&macro_tap_time 10>
                , <&macro_tap &kp C &kp Y &kp C>
                ;
        };
        magic_primary_chr_32: magic_primary_chr_32_macro {
            compatible = "zmk,behavior-macro";
            label = "MAGIC_PRIMARY_CHR_32";
            #binding-cells = <0>;
            bindings
                = <&macro_wait_time 10>
                , <&macro_tap_time 10>
                , <&macro_tap &kp T &kp H &kp E>
                ;
        };
        magic_primary_chr_44: magic_primary_chr_44_macro {
            compatible = "zmk,behavior-macro";
            label = "MAGIC_PRIMARY_CHR_44";
            #binding-cells = <0>;
            bindings
                = <&macro_wait_time 10>
                , <&macro_tap_time 10>
                , <&macro_tap &kp SPACE &kp B &kp U &kp T>
                ;
        };
        magic_alt_chr_32: magic_alt_chr_32_macro {
            compatible = "zmk,behavior-macro";
            label = "MAGIC_ALT_CHR_32";
            #binding-cells = <0>;
            bindings
                = <&macro_wait_time 10>
                , <&macro_tap_time 10>
                , <&macro_tap &kp T &kp H &kp E>
                ;
        };
        magic_alt_chr_44: magic_alt_chr_44_macro {
            compatible = "zmk,behavior-macro";
            label = "MAGIC_ALT_CHR_44";
            #binding-cells = <0>;
            bindings
                = <&macro_wait_time 10>
                , <&macro_tap_time 10>
                , <&macro_tap &kp SPACE &kp B &kp U &kp T>
                ;
        };
        magic_alt2_chr_32: magic_alt2_chr_32_macro {
            compatible = "zmk,behavior-macro";
            label = "MAGIC_ALT2_CHR_32";
            #binding-cells = <0>;
            bindings
                = <&macro_wait_time 10>
                , <&macro_tap_time 10>
                , <&macro_tap &kp T &kp H &kp E>
                ;
        };
        magic_alt2_chr_44: magic_alt2_chr_44_macro {
            compatible = "zmk,behavior-macro";
            label = "MAGIC_ALT2_CHR_44";
            #binding-cells = <0>;
            bindings
                = <&macro_wait_time 10>
                , <&macro_tap_time 10>
                , <&macro_tap &kp SPACE &kp B &kp U &kp T>
                ;
        };
    };

    // Magic key behaviors (adaptive key)
    // Each base layer has its own adaptive key with layer-specific mappings
    behaviors {
        // Adaptive key for BASE_PRIMARY family
        ak_primary: ak_primary {
            compatible = "zmk,behavior-adaptive-key";
            #binding-cells = <0>;
            bindings = <&key_repeat>;

            space_trigger {
                trigger-keys = <SPACE>;
                bindings = <&magic_primary_chr_32>;
                strict-modifiers;
                max-prior-idle-ms = <1000>;
            };
            comma_trigger {
                trigger-keys = <COMMA>;
                bindings = <&magic_primary_chr_44>;
                strict-modifiers;
                max-prior-idle-ms = <1000>;
            };
            minus_trigger {
                trigger-keys = <MINUS>;
                bindings = <&kp GT>;
                strict-modifiers;
                max-prior-idle-ms = <1000>;
            };
            dot_trigger {
                trigger-keys = <DOT>;
                bindings = <&kp FSLH>;
                strict-modifiers;
                max-prior-idle-ms = <1000>;
            };
            c_trigger {
                trigger-keys = <C>;
                bindings = <&kp Y>;
                max-prior-idle-ms = <1000>;
            };
            g_trigger {
                trigger-keys = <G>;
                bindings = <&kp Y>;
                max-prior-idle-ms = <1000>;
            };
            fslh_trigger {
                trigger-keys = <FSLH>;
                bindings = <&kp ASTERISK>;
                strict-modifiers;
                max-prior-idle-ms = <1000>;
            };
            asterisk_trigger {
                trigger-keys = <ASTERISK>;
                bindings = <&kp FSLH>;
                strict-modifiers;
                max-prior-idle-ms = <1000>;
            };
        };

        lt_ak_primary: lt_ak_primary {
            compatible = "zmk,behavior-hold-tap";
            label = "LT_AK_PRIMARY";
            #binding-cells = <2>;
            tapping-term-ms = <200>;
            quick-tap-ms = <200>;
            flavor = "balanced";
            bindings = <&mo>, <&ak_primary>;
        };

        mt_ak_primary: mt_ak_primary {
            compatible = "zmk,behavior-hold-tap";
            label = "MT_AK_PRIMARY";
            #binding-cells = <2>;
            tapping-term-ms = <200>;
            quick-tap-ms = <200>;
            flavor = "hold-preferred";
            bindings = <&kp>, <&ak_primary>;
        };

        // Adaptive key for BASE_ALT family
        ak_alt: ak_alt {
            compatible = "zmk,behavior-adaptive-key";
            #binding-cells = <0>;
            bindings = <&key_repeat>;

            space_trigger {
                trigger-keys = <SPACE>;
                bindings = <&magic_alt_chr_32>;
                strict-modifiers;
            };
            comma_trigger {
                trigger-keys = <COMMA>;
                bindings = <&magic_alt_chr_44>;
                strict-modifiers;
            };
            minus_trigger {
                trigger-keys = <MINUS>;
                bindings = <&kp GT>;
                strict-modifiers;
            };
            dot_trigger {
                trigger-keys = <DOT>;
                bindings = <&kp FSLH>;
                strict-modifiers;
            };
            fslh_trigger {
                trigger-keys = <FSLH>;
                bindings = <&kp ASTERISK>;
                strict-modifiers;
            };
            asterisk_trigger {
                trigger-keys = <ASTERISK>;
                bindings = <&kp FSLH>;
                strict-modifiers;
            };
        };

        lt_ak_alt: lt_ak_alt {
            compatible = "zmk,behavior-hold-tap";
            label = "LT_AK_ALT";
            #binding-cells = <2>;
            tapping-term-ms = <200>;
            quick-tap-ms = <200>;
            flavor = "balanced";
            bindings = <&mo>, <&ak_alt>;
        };

        mt_ak_alt: mt_ak_alt {
            compatible = "zmk,behavior-hold-tap";
            label = "MT_AK_ALT";
            #binding-cells = <2>;
            tapping-term-ms = <200>;
            quick-tap-ms = <200>;
            flavor = "hold-preferred";
            bindings = <&kp>, <&ak_alt>;
        };

        // Adaptive key for BASE_ALT2 family
        ak_alt2: ak_alt2 {
            compatible = "zmk,behavior-adaptive-key";
            #binding-cells = <0>;
            bindings = <&key_repeat>;

            space_trigger {
                trigger-keys = <SPACE>;
                bindings = <&magic_alt2_chr_32>;
                strict-modifiers;
            };
            comma_trigger {
                trigger-keys = <COMMA>;
                bindings = <&magic_alt2_chr_44>;
                strict-modifiers;
            };
            minus_trigger {
                trigger-keys = <MINUS>;
                bindings = <&kp GT>;
                strict-modifiers;
            };
            dot_trigger {
                trigger-keys = <DOT>;
                bindings = <&kp FSLH>;
                strict-modifiers;
            };
            fslh_trigger {
                trigger-keys = <FSLH>;
                bindings = <&kp ASTERISK>;
                strict-modifiers;
            };
            asterisk_trigger {
                trigger-keys = <ASTERISK>;
                bindings = <&kp FSLH>;
                strict-modifiers;
            };
        };

        lt_ak_alt2: lt_ak_alt2 {
            compatible = "zmk,behavior-hold-tap";
            label = "LT_AK_ALT2";
            #binding-cells = <2>;
            tapping-term-ms = <200>;
            quick-tap-ms = <200>;
            flavor = "balanced";
            bindings = <&mo>, <&ak_alt2>;
        };

        mt_ak_alt2: mt_ak_alt2 {
            compatible = "zmk,behavior-hold-tap";
            label = "MT_AK_ALT2";
            #binding-cells = <2>;
            tapping-term-ms = <200>;
            quick-tap-ms = <200>;
            flavor = "hold-preferred";
            bindings = <&kp>, <&ak_alt2>;
        };

    };

    // Magic training behaviors: punish direct bigrams with '#'
    behaviors {
        ak_train_primary_magic_primary_chr_32: ak_train_primary_magic_primary_chr_32 {
            compatible = "zmk,behavior-adaptive-key";
            #binding-cells = <0>;
            bindings = <&magic_primary_chr_32>;
            guard_trigger {
                trigger-keys = <SPACE>;
                bindings = <&kp HASH>;
                max-prior-idle-ms = <1000>;
            };
        };

        ak_train_primary_magic_primary_chr_44: ak_train_primary_magic_primary_chr_44 {
            compatible = "zmk,behavior-adaptive-key";
            #binding-cells = <0>;
            bindings = <&magic_primary_chr_44>;
            guard_trigger {
                trigger-keys = <COMMA>;
                bindings = <&kp HASH>;
                max-prior-idle-ms = <1000>;
            };
        };

        ak_train_primary_gt: ak_train_primary_gt {
            compatible = "zmk,behavior-adaptive-key";
            #binding-cells = <0>;
            bindings = <&kp GT>;
            guard_trigger {
                trigger-keys = <MINUS>;
                bindings = <&kp HASH>;
                max-prior-idle-ms = <1000>;
            };
        };

        ak_train_primary_fslh: ak_train_primary_fslh {
            compatible = "zmk,behavior-adaptive-key";
            #binding-cells = <0>;
            bindings = <&kp FSLH>;
            guard_trigger {
                trigger-keys = <DOT ASTERISK>;
                bindings = <&kp HASH>;
                max-prior-idle-ms = <1000>;
            };
        };

        ak_train_primary_y: ak_train_primary_y {
            compatible = "zmk,behavior-adaptive-key";
            #binding-cells = <0>;
            bindings = <&kp Y>;
            guard_trigger {
                trigger-keys = <C G>;
                bindings = <&kp HASH>;
                strict-modifiers;  // Disable training for shifted predecessors
                max-prior-idle-ms = <1000>;
            };
        };

        ak_train_primary_asterisk: ak_train_primary_asterisk {
            compatible = "zmk,behavior-adaptive-key";
            #binding-cells = <0>;
            bindings = <&kp ASTERISK>;
            guard_trigger {
                trigger-keys = <FSLH>;
                bindings = <&kp HASH>;
                max-prior-idle-ms = <1000>;
            };
        };

        ak_train_alt_magic_alt_chr_32: ak_train_alt_magic_alt_chr_32 {
            compatible = "zmk,behavior-adaptive-key";
            #binding-cells = <0>;
            bindings = <&magic_alt_chr_32>;
            guard_trigger {
                trigger-keys = <SPACE>;
                bindings = <&kp HASH>;
            };
        };

        ak_train_alt_magic_alt_chr_44: ak_train_alt_magic_alt_chr_44 {
            compatible = "zmk,behavior-adaptive-key";
            #binding-cells = <0>;
            bindings = <&magic_alt_chr_44>;
            guard_trigger {
                trigger-keys = <COMMA>;
                bindings = <&kp HASH>;
            };
        };

        ak_train_alt_gt: ak_train_alt_gt {
            compatible = "zmk,behavior-adaptive-key";
            #binding-cells = <0>;
            bindings = <&kp GT>;
            guard_trigger {
                trigger-keys = <MINUS>;
                bindings = <&kp HASH>;
            };
        };

        ak_train_alt_fslh: ak_train_alt_fslh {
            compatible = "zmk,behavior-adaptive-key";
            #binding-cells = <0>;
            bindings = <&kp FSLH>;
            guard_trigger {
                trigger-keys = <DOT ASTERISK>;
                bindings = <&kp HASH>;
            };
        };

        ak_train_alt_asterisk: ak_train_alt_asterisk {
            compatible = "zmk,behavior-adaptive-key";
            #binding-cells = <0>;
            bindings = <&kp ASTERISK>;
            guard_trigger {
                trigger-keys = <FSLH>;
                bindings = <&kp HASH>;
            };
        };

        ak_train_alt2_magic_alt2_chr_32: ak_train_alt2_magic_alt2_chr_32 {
            compatible = "zmk,behavior-adaptive-key";
            #binding-cells = <0>;
            bindings = <&magic_alt2_chr_32>;
            guard_trigger {
                trigger-keys = <SPACE>;
                bindings = <&kp HASH>;
            };
        };

        ak_train_alt2_magic_alt2_chr_44: ak_train_alt2_magic_alt2_chr_44 {
            compatible = "zmk,behavior-adaptive-key";
            #binding-cells = <0>;
            bindings = <&magic_alt2_chr_44>;
            guard_trigger {
                trigger-keys = <COMMA>;
                bindings = <&kp HASH>;
            };
        };

        ak_train_alt2_gt: ak_train_alt2_gt {
            compatible = "zmk,behavior-adaptive-key";
            #binding-cells = <0>;
            bindings = <&kp GT>;
            guard_trigger {
                trigger-keys = <MINUS>;
                bindings = <&kp HASH>;
            };
        };

        ak_train_alt2_fslh: ak_train_alt2_fslh {
            compatible = "zmk,behavior-adaptive-key";
            #binding-cells = <0>;
            bindings = <&kp FSLH>;
            guard_trigger {
                trigger-keys = <DOT ASTERISK>;
                bindings = <&kp HASH>;
            };
        };

        ak_train_alt2_asterisk: ak_train_alt2_asterisk {
            compatible = "zmk,behavior-adaptive-key";
            #binding-cells = <0>;
            bindings = <&kp ASTERISK>;
            guard_trigger {
                trigger-keys = <FSLH>;
                bindings = <&kp HASH>;
            };
        };

    };

    // Shift-morph behaviors (mod-morph)
    // These output a different key when shift is held
    behaviors {
        sm_dot_grv: sm_dot_grv {
            compatible = "zmk,behavior-mod-morph";
            #binding-cells = <0>;
            bindings = <&kp DOT>, <&kp GRAVE>;
            mods = <(MOD_LSFT|MOD_RSFT)>;
        };

        sm_comm_at: sm_comm_at {
            compatible = "zmk,behavior-mod-morph";
            #binding-cells = <0>;
            bindings = <&kp COMMA>, <&kp AT>;
            mods = <(MOD_LSFT|MOD_RSFT)>;
        };

    };
    keymap {
        compatible = "zmk,keymap";

        base_primary_layer {
            bindings = <
                &none &kp B &kp F &kp L &kp K &kp Q &kp P &kp G &kp O &kp U &sm_dot_grv &none
                &key_repeat &hml LGUI N &hml LALT S &hml LCTL H &hml LSFT T &kp M &ak_train_primary_y &hmr LSFT C &hmr LCTL A &hmr LALT E &hmr LGUI I &key_repeat
                &none &kp X &kp V &kp J &kp D &kp Z &kp SQT &kp W &kp MINUS &ak_train_primary_fslh &sm_comm_at &none
                &lt_ak_primary NUM 0 &lt SYM R &mt LSFT BSPC &mt LSFT TAB &lt NAV SPACE &lt MEDIA ENTER
            >;
        };

        base_alt_layer {
            bindings = <
                &none &kp B &kp F &kp L &kp K &kp Q &kp J &kp G &kp O &kp U &sm_dot_grv &none
                &none &hml LGUI N &hml LALT S &hml LCTL H &hml LSFT T &kp D &kp Y &hmr LSFT C &hmr LCTL A &hmr LALT E &hmr LGUI I &none
                &none &kp X &kp V &kp M &kp P &kp Z &kp SQT &kp W &kp MINUS &ak_train_alt_fslh &sm_comm_at &none
                &lt_ak_alt NUM 0 &lt SYM R &mt LSFT BSPC &mt LSFT TAB &lt NAV SPACE &lt MEDIA ENTER
            >;
        };

        base_alt2_layer {
            bindings = <
                &none &kp B &kp L &kp M &kp C &kp Z &kp J &kp F &kp O &kp U &sm_dot_grv &none
                &key_repeat &hml LGUI N &hml LALT R &hml LCTL T &hml LSFT D &kp P &kp Y &hmr LSFT H &hmr LCTL A &hmr LALT E &hmr LGUI I &key_repeat
                &none &kp X &kp Q &kp V &kp G &kp W &kp SQT &kp K &kp MINUS &ak_train_alt2_fslh &sm_comm_at &none
                &lt_ak_alt2 NUM 0 &lt SYM S &mt LSFT BSPC &mt LSFT TAB &lt NAV SPACE &lt MEDIA ENTER
            >;
        };

        sym_layer {
            bindings = <
                &trans &kp AMPERSAND &kp PERCENT &kp DOLLAR &sl NUM &none &kp HASH &kp PLUS &kp LBRC &kp RBRC &kp EQUAL &trans
                &trans &hml LGUI LT &hml LALT GT &hml LCTL LBKT &hml LSFT RBKT &none &kp SEMI &kp EXCL &kp LPAR &kp RPAR &kp COLON &trans
                &trans &kp CARET &kp PIPE &kp TILDE &kp BSLH &none &kp DQT &ak_train_primary_asterisk &kp UNDERSCORE &kp QUESTION &kp COMMA &trans
                &none &none &none &ak_primary &kp SPACE &kp ENTER
            >;
        };

        num_layer {
            bindings = <
                &trans &kp AMPERSAND &kp PERCENT &kp DOLLAR &sl SYM_SHADOW &none &kp HASH &kp N7 &kp N8 &kp N9 &kp DOT &trans
                &trans &hml LGUI LT &hml LALT GT &hml LCTL LBKT &hml LSFT RBKT &none &kp SEMI &kp N1 &kp N2 &kp N3 &kp N0 &trans
                &trans &kp LG(Z) &kp LG(X) &kp LG(C) &kp LG(V) &kp LG(LS(Z)) &kp DQT &kp N4 &kp N5 &kp N6 &kp COMMA &trans
                &none &none &none &ak_primary &kp SPACE &kp ENTER
            >;
        };

        nav_layer {
            bindings = <
                &trans &none &kp PG_UP &none &caps_word &kp ESC &none &none &none &none &none &trans
                &trans &none &kp LEFT &kp UP &kp RIGHT &kp CAPS &none &kp LSHFT &kp LCTRL &kp LALT &kp LGUI &trans
                &trans &kp END &kp PG_DN &kp DOWN &kp HOME &kp INS &none &none &none &none &none &trans
                &kp DEL &kp ENTER &kp BSPC &none &none &none
            >;
        };

        media_layer {
            bindings = <
                &trans &to BASE_PRIMARY &to BASE_ALT &to BASE_ALT2 &none &none &bt BT_SEL 0 &bt BT_SEL 1 &bt BT_SEL 2 &bt BT_SEL 3 &bt BT_CLR &trans
                &trans &kp C_NEXT &kp C_VOL_UP &kp C_VOL_DN &kp C_PREV &none &none &kp LSHFT &kp LCTRL &kp LALT &kp LGUI &trans
                &trans &kp LG(Z) &kp LG(X) &kp LG(C) &kp LG(V) &kp LG(LS(Z)) &none &none &none &none &bootloader &trans
                &kp C_MUTE &kp C_PLAY_PAUSE &kp C_STOP &none &none &none
            >;
        };

        sym_shadow_layer {
            bindings = <
                &trans &kp AMPERSAND &kp PERCENT &kp DOLLAR &sl NUM &none &kp HASH &kp PLUS &kp LBRC &kp RBRC &kp EQUAL &trans
                &trans &hml LGUI LT &hml LALT GT &hml LCTL LBKT &hml LSFT RBKT &none &kp SEMI &kp EXCL &kp LPAR &kp RPAR &kp COLON &trans
                &trans &kp CARET &kp PIPE &kp TILDE &kp BSLH &none &kp DQT &ak_train_primary_asterisk &kp UNDERSCORE &kp QUESTION &kp COMMA &trans
                &none &none &none &ak_primary &kp SPACE &kp ENTER
            >;
        };
    };
};
